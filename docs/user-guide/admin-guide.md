# 管理员使用手册

本手册面向系统管理员，介绍管理面板的所有功能和操作流程。

---

## 📋 管理员职责

管理员是系统的最高权限用户，负责：
- 管理所有用户账户
- 配置学期和评分周期
- 配置参与评分的班级
- 设置评分权重
- 导出数据报告
- 备份系统数据
- 维护系统安全

---

## 🚀 快速开始

### 首次登录

1. 访问系统地址：`http://your-domain.com`
2. 使用管理员账户登录：
   - 用户名：`admin`
   - 密码：`admin123`（首次登录后请立即修改）

3. 进入管理面板

**⚠️ 重要：首次登录后，请立即修改默认密码！**

---

## 👥 用户管理

### 查看用户列表

1. 点击顶部导航栏的 **"用户管理"**
2. 查看所有用户的信息：
   - 用户名
   - 角色（admin/student/new_media_officer）
   - 年级
   - 班级
   - 创建时间

### 创建新用户

1. 点击 **"创建新用户"** 按钮
2. 填写用户信息：
   - **用户名**：唯一标识，建议使用规范命名
     - 信息委员：`s6c1`（六年级1班信息委员）
     - 新媒体委员：`nm6`（六年级新媒体委员）
   - **密码**：初始密码，建议用户首次登录后修改
   - **角色**：选择用户角色
     - `admin`：管理员
     - `student`：信息委员
     - `new_media_officer`：新媒体委员
   - **年级**：如 `6`（信息委员和新媒体委员必填）
   - **班级**：如 `1`（仅信息委员需要）
3. 点击 **"创建"** 按钮

**用户命名规范建议：**
- 信息委员：`s + 年级号 + c + 班级号`（如 `s6c1` 表示六年级1班信息委员）
- 新媒体委员：`nm + 年级号`（如 `nm6` 表示六年级新媒体委员）

### 删除用户

1. 在用户列表中找到要删除的用户
2. 点击用户行右侧的 **"删除"** 按钮
3. 在确认对话框中确认删除

**注意：** 删除用户不会删除该用户的历史评分记录。

### 重置用户密码

1. 使用命令行工具重置密码：
   ```bash
   python scripts/reset_password.py
   ```
2. 按照提示输入用户名和新密码
3. 或在数据库中直接修改（需要技术支持）

---

## 📅 学期配置

### 配置新学期

1. 点击顶部导航栏的 **"学期设置"**
2. 填写学期基本信息：
   - **学期名称**：如 `2024-2025学年第一学期`
   - **开始日期**：学期开始日期
   - **第一周期结束日期**：第一个评分周期的结束日期
   - **周期类型**：选择默认评分周期
     - **双周 (14天)**：每14天一个周期
     - **单周 (7天)**：每7天一个周期

3. 点击 **"保存配置"**

### 配置参与班级

1. 在学期设置页面找到 **"参与班级配置"** 区域
2. 点击 **"添加班级"**
3. 输入班级信息：
   - 年级号（如 `6`）
   - 班级号（如 `1`）
4. 重复步骤2-3添加所有参与评分的班级
5. 点击 **"保存班级配置"**

**删除班级：**
- 点击班级列表中的 **"删除"** 按钮
- 确认删除（不会影响历史数据）

### 查看学期信息

在学期设置页面可以看到：
- 当前学期名称
- 学期时间范围
- 当前周期类型
- 当前周期号
- 参与班级列表

---

## 🔄 动态周期管理

### 查看当前周期配置

在 **学期设置** 页面的 **"评分周期配置"** 卡片中，可以看到：
- 当前周期类型（单周/双周）
- 当前周期号
- 周期开始和结束日期

### 变更周期类型

1. 在 **评分周期配置** 区域选择新的周期类型
2. 选择生效日期（必须是未来日期）
3. 填写变更原因（可选但建议填写）
4. 点击 **"变更周期类型"** 按钮
5. 在确认对话框中确认操作

**重要说明：**
- 变更不会立即生效，会在指定日期的下一个周期开始时生效
- 当前周期不会受到影响
- 所有历史数据保持不变

### 查看配置历史

1. 点击 **"查看配置历史"** 按钮
2. 查看所有周期类型变更记录：
   - 变更时间
   - 变更类型
   - 生效日期
   - 操作人
   - 变更原因

详细说明请参考 [动态周期使用指南](dynamic-period-usage.md)

---

## ⚖️ 权重配置

### 设置评分权重

1. 进入 **"权重配置"** 页面
2. 为各评分项设置权重：
   - 电脑整洁度
   - 物品摆放
   - 使用规范
   - 其他项目
3. 确保权重总和为 100%
4. 点击 **"保存权重"**

**注意：** 权重变更会影响未来的评分统计，不会重新计算历史数据。

---

## 📊 数据导出

### 导出 Excel 报告

1. 进入 **"数据中心"** 或 **"学期设置"** 页面
2. 点击 **"导出 Excel 报告"** 按钮
3. 选择导出范围：
   - 全部数据
   - 指定周期
   - 指定年级
4. 点击 **"导出"**

**报告内容：**
- **评分详情表**：所有评分记录
- **历史记录表**：被覆盖的评分
- **汇总矩阵**：班级×周期评分矩阵
- **统计分析**：平均分、最高分、最低分

文件格式：`.xlsx`，文件名包含日期时间戳。

### 导出筛选建议

- **学期总结**：导出全部数据
- **周期报告**：导出单个周期数据
- **年级分析**：导出指定年级数据

---

## 💾 数据备份

### 备份数据库

1. 进入 **"数据中心"** 页面
2. 点击 **"备份数据库"** 按钮
3. 选择备份格式：
   - **SQLite (.db)**：适用于 SQLite 数据库
   - **PostgreSQL (.sql)**：适用于 PostgreSQL 数据库
4. 点击 **"下载备份"**

**备份频率建议：**
- **日常备份**：每周一次
- **重要操作前**：必须备份
- **学期结束**：完整备份

### 恢复数据

**SQLite：**
```bash
# 停止应用
# 替换数据库文件
cp backup.db src/classcomp/database/classcomp.db
# 重启应用
```

**PostgreSQL：**
```bash
# 恢复数据库
psql -h your_host -U your_user -d your_database < backup.sql
```

---

## 📈 数据统计

### 查看统计数据

在管理面板首页可以看到：
- 系统使用统计
- 用户活跃度
- 评分完成情况
- 各年级对比分析

### 统计图表

- **今日评分趋势**：查看今日评分数量变化
- **周期完成率**：各周期评分完成百分比
- **年级对比**：各年级平均分对比
- **班级排名**：班级评分排行榜

---

## 🔒 安全管理

### 更改管理员密码

**方法一：在系统中更改**
1. 点击右上角用户名
2. 选择 **"修改密码"**
3. 输入当前密码和新密码
4. 点击 **"确认修改"**

**方法二：使用脚本重置**
```bash
python scripts/reset_password.py
# 输入用户名：admin
# 输入新密码：your-new-password
```

### 安全建议

1. **定期更改密码**：建议每学期更改一次
2. **使用强密码**：至少8位，包含字母、数字、符号
3. **不要共享账户**：每个管理员使用独立账户
4. **定期备份数据**：防止数据丢失
5. **监控异常登录**：注意异常时间和地点的登录

### 查看操作日志

查看 `logs/application.log` 文件：
```bash
# 查看最近的操作
tail -f logs/application.log

# 搜索特定用户的操作
grep "admin" logs/application.log
```

---

## 🔍 常见问题

### Q1: 如何批量创建用户？

**A:** 目前需要逐个创建。如需批量创建，可以：
1. 直接在数据库中插入用户记录
2. 联系技术支持获取批量导入脚本

### Q2: 删除用户会影响历史数据吗？

**A:** 不会。删除用户只会删除账户，该用户提交的所有历史评分记录都会保留。

### Q3: 如何处理忘记密码的用户？

**A:** 使用密码重置脚本：
```bash
python scripts/reset_password.py
```

### Q4: 学期配置能修改吗？

**A:** 可以修改，但建议学期开始后不要频繁修改，特别是周期类型和参与班级。

### Q5: 数据导出失败怎么办？

**A:** 检查：
1. 磁盘空间是否充足
2. 导出目录权限是否正确
3. 数据库连接是否正常
4. 查看错误日志获取详细信息

---

## 💡 最佳实践

### 学期开始前

- [ ] 配置新学期信息
- [ ] 添加参与班级
- [ ] 创建所有用户账户
- [ ] 设置评分权重
- [ ] 测试评分流程

### 学期进行中

- [ ] 每周检查评分完成情况
- [ ] 定期导出数据报告
- [ ] 每周备份数据库
- [ ] 监控系统运行状态
- [ ] 及时处理用户问题

### 学期结束后

- [ ] 导出完整学期数据
- [ ] 完整备份数据库
- [ ] 归档学期报告
- [ ] 总结经验教训
- [ ] 准备下学期配置

---

## 📞 技术支持

遇到问题？
- 📖 [故障排除指南](../troubleshooting.md)
- 🚀 [部署指南](../deployment/)
- 🐛 [提交 Issue](https://github.com/your-repo/ClassComp-Score/issues)

---

## 📚 相关文档

- [信息委员使用手册](info-commissioner-guide.md)
- [新媒体委员使用手册](new-media-officer-guide.md)
- [动态周期使用指南](dynamic-period-usage.md)
- [快速开始](../quick-start.md)

---

**提示：** 作为管理员，您对系统的稳定运行和数据安全负有重要责任。请定期备份数据，谨慎操作！